System.register("chunks:///_virtual/GameContent.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){var t,n,o,r,l,i;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.initializerDefineProperty},function(e){o=e.cclegacy,r=e.Label,l=e._decorator,i=e.Component}],execute:function(){var a,s,c,u,p;o._RF.push({},"bee3fBNNvJPPq9BU/XUHvI3","GameContent",void 0);const{ccclass:b,property:d}=l;e("GameContent",(a=b("GameContent"),s=d(r),a((p=t((u=class extends i{constructor(...e){super(...e),n(this,"label",p,this)}onLoad(){console.log("onLoad is called version 1.0.3"),this.label&&(this.label.string="Inital one ")}}).prototype,"label",[s],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),c=u))||c));o._RF.pop()}}}));

System.register("chunks:///_virtual/main",["./GameContent.ts","./RemoteEntryLoader.ts"],(function(){return{setters:[null,null],execute:function(){}}}));

System.register("chunks:///_virtual/RemoteEntryLoader.ts",["./rollupPluginModLoBabelHelpers.js","cc","./env"],(function(e){var t,s,a,i,n,r,o,c,d,l,h,f,p;return{setters:[function(e){t=e.applyDecoratedDescriptor,s=e.initializerDefineProperty},function(e){a=e.cclegacy,i=e.Asset,n=e.Label,r=e.ProgressBar,o=e.Button,c=e._decorator,d=e.Component,l=e.native,h=e.sys,f=e.game},function(e){p=e.NATIVE}],execute:function(){var g,u,b,m,U,y,M,E,F,k,v,L,R;a._RF.push({},"bd9f3f3xF9NvYxZN8P+pIm1","RemoteEntryLoader",void 0);const{ccclass:B,property:P}=c;JSON.stringify({packageUrl:"https://thanisthani.github.io/CocosHotUpdate/remote-assets/",remoteVersionUrl:"https://thanisthani.github.io/CocosHotUpdate/remote-assets/version.manifest",remoteManifestUrl:"https://thanisthani.github.io/CocosHotUpdate/remote-assets/project.manifest",version:"1.0.1",assets:{"application.js":{md5:"e56639acc2fadbe3cdd20ed959694c80",size:1269},"assets/internal/cc.config.json":{md5:"6b232e5c1e60eacb53201ee644c96d09",size:2021},"assets/internal/import/06/06585a170.json":{md5:"c06710857fd7f811dc5cf997ad4a3d1b",size:182434},"assets/internal/index.js":{md5:"485ec411d67c319c19f92a77040401f2",size:39548},"assets/main/cc.config.json":{md5:"193f33083ed12f6c2419f9f33ac56415",size:725},"assets/main/import/0a/0abfc91e1.json":{md5:"131834333d8457749dffbb50e4ec0538",size:2952},"assets/main/import/22/22a22708-11d9-4581-8564-751935cdd74c.json":{md5:"a253314ec7107d95345d7fc89b8d7bb5",size:72},"assets/main/import/22/22a22708-11d9-4581-8564-751935cdd74c@6c48a.json":{md5:"2c15e07fa8b0bbd0c9d00c0c25d27380",size:104},"assets/main/import/ba/ba21476f-2866-4f81-9c4d-6e359316e448.json":{md5:"8bce784945efd554512e8520ec9caccb",size:192},"assets/main/import/fd/fd8ec536-a354-4a17-9c74-4f3883c378c8.json":{md5:"731f44a39ce9377ee6de8ba34edaf039",size:480},"assets/main/index.js":{md5:"fb35682025abdd8ff67540a131883db0",size:8843},"assets/main/native/22/22a22708-11d9-4581-8564-751935cdd74c.png":{md5:"cb181f1870ecc94fd2fc38cfff337826",size:25534},"assets/main/native/f6/f68fd36f-24da-4868-82b3-35759975edff.manifest":{md5:"45dd6fa3f3dda609d6684ed235ab7ad9",size:2964},"jsb-adapter/engine-adapter.js":{md5:"d7c197e587a97d0240e760508b009865",size:168637},"jsb-adapter/web-adapter.js":{md5:"2ab62c17fde76578b00670430e4a09bf",size:173353},"main.js":{md5:"e3167153cd7edbda3a1b2550fb24194a",size:840},"src/chunks/bundle.js":{md5:"5090af38add59c9ee667e7aa7630e033",size:976},"src/cocos-js/cc.js":{md5:"2b73eb923056ca6eddef8cbc89ff6f5a",size:1879194},"src/effect.bin":{md5:"4f2f1c1f24379fb11eeff163fb321177",size:5442},"src/import-map.json":{md5:"fc840d99cbb3732367a93c054d1200d4",size:37},"src/settings.json":{md5:"c1c716b026f412733bcbd66e8ad4f64c",size:21284},"src/system.bundle.js":{md5:"f45da0108c6bc0747a05f0f669023838",size:8319}},searchPaths:[]});e("RemoteEntryLoader",(g=B("RemoteEntryLoader"),u=P(i),b=P(n),m=P(r),U=P(o),y=P(o),g((F=t((E=class extends d{constructor(...e){super(...e),s(this,"manifestUrl",F,this),s(this,"statusLabel",k,this),s(this,"progressBar",v,this),s(this,"checkUpdateBtn",L,this),s(this,"retryBtn",R,this),this.assetsManager=null,this.storagePath="",this.updating=!1,this.canRetry=!1,this.updateListener=null}onLoad(){this.storagePath=(l.fileUtils&&l.fileUtils.getWritablePath?l.fileUtils.getWritablePath():"/")+"hot-update/",this.initHotUpdate(),this.setupUI()}initHotUpdate(){try{if(p){const e=l.fileUtils.getWritablePath()+"hot-update/";console.log("Hot update directory exists:",l.fileUtils.isDirectoryExist(e)),console.log("Manifest exists:",l.fileUtils.isFileExist(e+"project.manifest"));const t=l.fileUtils.listFiles(e);console.log("Files in hot update directory:",t)}l.fileUtils.isDirectoryExist(this.storagePath)||l.fileUtils.createDirectory(this.storagePath),this.assetsManager=new l.AssetsManager(this.manifestUrl.nativeUrl,this.storagePath),this.setupSearchPaths(),this.assetsManager.setMaxConcurrentTask(5),this.assetsManager.setVersionCompareHandle(((e,t)=>this.compareVersion(e,t))),this.assetsManager.setVerifyCallback(((e,t)=>this.verifyAsset(e,t))),this.updateListener=e=>this.updateCallback(e),this.assetsManager.setEventCallback(this.updateListener),this.statusLabel.string="Hot update initialized"}catch(e){console.error("Failed to initialize hot update:",e),this.statusLabel.string="Failed to initialize hot update"}}setupSearchPaths(){if(this.assetsManager)try{this.assetsManager.getState()===l.AssetsManager.State.UNINITED&&(console.log("loadLocalManifest is called"),this.manifestUrl&&this.manifestUrl.nativeUrl&&this.assetsManager.loadLocalManifest(this.manifestUrl.nativeUrl));const e=this.assetsManager.getLocalManifest();if(!e||!e.isLoaded())throw console.log("Failed to load bundled manifest"),new Error("Failed to load bundled manifest");if(e&&e.isLoaded()){console.log("localManifest is loaded");const t=e.getSearchPaths(),s=l.fileUtils.getSearchPaths();Array.prototype.unshift.apply(s,t),l.fileUtils.setSearchPaths(s),console.log("Search paths updated:",s)}}catch(e){console.error("Failed to setup search paths:",e)}}setupUI(){this.checkUpdateBtn&&this.checkUpdateBtn.node.on("click",this.checkForUpdate,this),this.retryBtn&&(this.retryBtn.node.on("click",this.retry,this),this.retryBtn.node.active=!1)}checkForUpdate(){this.assetsManager&&!this.updating&&(console.log("checkForUpdate is called"),this.updating=!0,this.canRetry=!1,this.checkUpdateBtn.node.active=!1,this.retryBtn.node.active=!1,this.statusLabel.string="Checking for updates...",this.progressBar.progress=0,this.assetsManager.checkUpdate())}retry(){this.canRetry&&(this.canRetry=!1,this.retryBtn.node.active=!1,this.statusLabel.string="Retrying failed downloads...",this.assetsManager.downloadFailedAssets())}updateCallback(e){const t=e.getEventCode();switch(console.log("update eventCode is",t),t){case l.EventAssetsManager.ERROR_NO_LOCAL_MANIFEST:this.statusLabel.string="No local manifest file found",this.onUpdateFinished(!1);break;case l.EventAssetsManager.ERROR_DOWNLOAD_MANIFEST:this.statusLabel.string="Failed to download manifest",this.onUpdateFinished(!1);break;case l.EventAssetsManager.ERROR_PARSE_MANIFEST:this.statusLabel.string="Failed to parse manifest",this.onUpdateFinished(!1);break;case l.EventAssetsManager.NEW_VERSION_FOUND:this.statusLabel.string="New version found, starting download...",this.assetsManager.update();break;case l.EventAssetsManager.ALREADY_UP_TO_DATE:this.statusLabel.string="Already up to date",this.onUpdateFinished(!0);break;case l.EventAssetsManager.UPDATE_PROGRESSION:this.handleUpdateProgress(e);break;case l.EventAssetsManager.ASSET_UPDATED:break;case l.EventAssetsManager.ERROR_UPDATING:this.statusLabel.string="Update error: "+e.getMessage(),this.onUpdateFinished(!1);break;case l.EventAssetsManager.UPDATE_FINISHED:this.statusLabel.string="Update completed! Restart required.";const t=l.fileUtils.getSearchPaths();console.log("searchPaths is",t);const s=this.storagePath,a=t.indexOf(s);a>-1&&t.splice(a,1),t.unshift(s),l.fileUtils.setSearchPaths(t),console.log("updated searchPaths is",t),h.localStorage.setItem("hotUpdateReady","true"),h.localStorage.setItem("hotUpdatePath",s),this.onUpdateFinished(!0,!0);break;case l.EventAssetsManager.UPDATE_FAILED:this.statusLabel.string="Update failed: "+e.getMessage(),this.canRetry=!0,this.retryBtn.node.active=!0,this.onUpdateFinished(!1);break;case l.EventAssetsManager.ERROR_DECOMPRESS:this.statusLabel.string="Decompression failed",this.onUpdateFinished(!1)}}handleUpdateProgress(e){const t=e.getPercent(),s=(e.getPercentByFile(),e.getDownloadedBytes()),a=e.getTotalBytes(),i=e.getDownloadedFiles(),n=e.getTotalFiles();this.progressBar.progress=t/100,this.statusLabel.string=`Downloading... ${Math.floor(t)}%\nFiles: ${i}/${n}\nSize: ${this.formatBytes(s)}/${this.formatBytes(a)}`,console.log(`Downloading... ${Math.floor(t)}%\nFiles: ${i}/${n}\nSize: ${this.formatBytes(s)}/${this.formatBytes(a)}`)}onUpdateFinished(e,t=!1){this.updating=!1,this.checkUpdateBtn.node.active=!0,t&&this.showRestartOption()}showRestartOption(){this.statusLabel.string="Update completed! Tap to restart.",this.checkUpdateBtn.getComponentInChildren(n).string="Restart Game",this.checkUpdateBtn.node.off("click",this.checkForUpdate,this),this.checkUpdateBtn.node.on("click",this.restartGame,this)}restartGame(){console.log("restartGame is called"),this.assetsManager&&this.assetsManager.setEventCallback(null),f.restart()}compareVersion(e,t){const s=e=>e.split(".").map((e=>parseInt(e)||0)),a=s(e),i=s(t);for(let e=0;e<Math.max(a.length,i.length);e++){const t=a[e]||0,s=i[e]||0;if(t!==s)return t-s}return 0}verifyAsset(e,t){return!0}formatBytes(e){if(0===e)return"0 B";const t=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,t)).toFixed(2))+" "+["B","KB","MB","GB"][t]}onDestroy(){this.assetsManager&&this.updateListener&&this.assetsManager.setEventCallback(null)}}).prototype,"manifestUrl",[u],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),k=t(E.prototype,"statusLabel",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),v=t(E.prototype,"progressBar",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),L=t(E.prototype,"checkUpdateBtn",[U],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),R=t(E.prototype,"retryBtn",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),M=E))||M));a._RF.pop()}}}));

(function(r) {
  r('virtual:///prerequisite-imports/main', 'chunks:///_virtual/main'); 
})(function(mid, cid) {
    System.register(mid, [cid], function (_export, _context) {
    return {
        setters: [function(_m) {
            var _exportObj = {};

            for (var _key in _m) {
              if (_key !== "default" && _key !== "__esModule") _exportObj[_key] = _m[_key];
            }
      
            _export(_exportObj);
        }],
        execute: function () { }
    };
    });
});